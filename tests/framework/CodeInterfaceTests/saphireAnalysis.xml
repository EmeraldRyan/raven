<?xml version="1.0" ?>
<Simulation verbosity="debug">
  <TestInfo>
    <name>saphire</name>
    <author>wangc</author>
    <created>2018-08-31</created>
    <classesTested>CodeInterface</classesTested>
    <description>
       This test is for Sept Milestone
    </description>
  </TestInfo>
  <RunInfo>
    <JobName>saphire</JobName>
    <Sequence>load,plot</Sequence>
    <!--
    <Sequence>sample,plot</Sequence>
    -->
    <WorkingDir>saphireAnalysis</WorkingDir>
    <batchSize>1</batchSize>
  </RunInfo>

  <Files>
    <Input name="macro" type="">Class_Chg_DEMO.mac</Input>
    <Input name="demo" type="">demo.zip</Input>
    <Input name='saphireCSV' type=''>saphirePrint.csv</Input>
  </Files>

  <Models>
    <Code name="saphire" subType="Saphire">
      <executable>"C:\Saphire 8\tools\SAPHIRE.exe"</executable>
      <clargs arg="macro" extension=".mac" type="input" delimiter="="/>
      <clargs arg="project" extension=".zip" type="input" delimiter="="/>
      <outputFile>fixed_output.csv</outputFile>
      <codeOutput type="uncertainty">et_uq.csv</codeOutput>
      <codeOutput type="uncertainty">ft_uq.csv</codeOutput>
    </Code>
  </Models>

  <Distributions>

    <Uniform name='time-dist'>
	<lowerBound>0.0</lowerBound>
	<upperBound>20.0</upperBound>
    </Uniform>
    <!--
    <Beta name="CKV-CC-EVENTS">
	<low>0</low>
	<high>1</high>
	<alpha>0.5</alpha>
	<beta>4999.5</beta>
    </Beta>
    <Beta name="MOV-1-EVENTS">
	<low>0</low>
	<high>1</high>
	<alpha>0.5</alpha>
	<beta>2499.5</beta>
    </Beta>
    <Beta name="MOV-CC-EVENTS">
	<low>0</low>
	<high>1</high>
	<alpha>0.5</alpha>
	<beta>499.5</beta>
    </Beta>
    <Beta name="PMP-FS-EVENTS">
	<low>0</low>
	<high>1</high>
	<alpha>0.5</alpha>
	<beta>416.167</beta>
    </Beta>
    <Beta name="DGN-FS-EVENTS">
	<low>0</low>
	<high>1</high>
	<alpha>0.5</alpha>
	<beta>124.5</beta>
    </Beta>
    <Beta name="CKV-1-EVENTS">
	<low>0</low>
	<high>1</high>
	<alpha>0.5</alpha>
	<beta>0.013347</beta>
    </Beta>
    <Beta name="CKV-2-EVENTS">
	<low>0</low>
	<high>1</high>
	<alpha>0.5</alpha>
	<beta>23.89</beta>
    </Beta>

    <Gamma name="PMP-FR-EVENTS-lambda">
	<alpha>0.5</alpha>
	<beta>23809.5</beta>
	<low>0</low>
    </Gamma>
    <Gamma name="DGN-FR-EVENTS-lambda">
	<alpha>0.5</alpha>
	<beta>561.8</beta>
	<low>0</low>
    </Gamma>
    -->
  </Distributions>

  <Functions>
    <External name='ckv_cc' file='ckv_cc.py'>
        <variable>time</variable>
    </External>
    <External name='mov_cc_1' file='mov_cc_1.py'>
        <variable>time</variable>
    </External>
    <External name='mov_cc' file='mov_cc.py'>
        <variable>time</variable>
    </External>
    <External name='pmp_fs' file='pmp_fs.py'>
        <variable>time</variable>
    </External>
    <External name='dgn_fs' file='dgn_fs.py'>
        <variable>time</variable>
    </External>
    <External name='ckv_1' file='ckv_1.py'>
        <variable>time</variable>
    </External>
    <External name='ckv_2' file='ckv_2.py'>
        <variable>time</variable>
    </External>
    <External name='pmp_fr' file='pmp_fr.py'>
        <variable>time</variable>
    </External>
    <External name='dgn_fr' file='dgn_fr.py'>
        <variable>time</variable>
    </External>
  </Functions>

  <Samplers>
    <Grid name='gridSaphire'>
	<variable name='time'>
	  <distribution>time-dist</distribution>
	  <grid construction='equal' steps='40' type='value'>0.0 20.0</grid>
  	</variable>
	<variable name='CKV-CC'>
	  <function>ckv_cc</function>
	</variable>
	<variable name='MOV-CC-1'>
	  <function>mov_cc_1</function>
	</variable>
	<variable name='MOV-CC'>
	  <function>mov_cc</function>
	</variable>
	<variable name='PMP-FS'>
	  <function>pmp_fs</function>
	</variable>
	<variable name='DGN-FS'>
	  <function>dgn_fs</function>
	</variable>
	<variable name='CKV-1'>
	  <function>ckv_1</function>
	</variable>
	<variable name='CKV-2'>
	  <function>ckv_2</function>
	</variable>
	<variable name='PMP-FR-lambda'>
	  <function>pmp_fr</function>
	</variable>
	<variable name='DGN-FR-lambda'>
	  <function>dgn_fr</function>
	</variable>
    </Grid>
    <!--
    <MonteCarlo name="mcSaphire">
        <samplerInit>
            <limit>2</limit>
        </samplerInit>
        <variable name="CKV-CC">
            <distribution>CKV-CC-EVENTS</distribution>
        </variable>
        <variable name="MOV-CC-1">
            <distribution>MOV-1-EVENTS</distribution>
        </variable>
        <variable name="MOV-CC">
            <distribution>MOV-CC-EVENTS</distribution>
        </variable>
        <variable name="PMP-FS">
            <distribution>PMP-FS-EVENTS</distribution>
        </variable>
        <variable name="DGN-FS">
            <distribution>DGN-FS-EVENTS</distribution>
        </variable>
        <variable name="CKV-1">
            <distribution>CKV-1-EVENTS</distribution>
        </variable>
        <variable name="CKV-2">
            <distribution>CKV-2-EVENTS</distribution>
        </variable>
        <variable name="PMP-FR-lambda">
            <distribution>PMP-FR-EVENTS-lambda</distribution>
        </variable>
        <variable name="DGN-FR-lambda">
            <distribution>DGN-FR-EVENTS-lambda</distribution>
        </variable>
    </MonteCarlo>
    -->

  </Samplers>

  <Steps>
    <MultiRun name="sample">
      <Input class="Files" type="">macro</Input>
      <Input class="Files" type="">demo</Input>
      <Model class="Models" type="Code">saphire</Model>
      <Sampler class="Samplers" type="MonteCarlo">gridSaphire</Sampler>
      <Output class="DataObjects" type="PointSet">saphireDump</Output>
      <Output class="OutStreams" type="Print">saphirePrint</Output>
    </MultiRun>
    <IOStep name='plot' pauseAtEnd='True'>
      <Input class='DataObjects' type='PointSet'>saphireDump</Input>
      <Output class='OutStreams' type='Plot'>Large-Release</Output>
      <Output class='OutStreams' type='Plot'>Small-Release</Output>
      <Output class='OutStreams' type='Plot'>Containment-Cooling-System</Output>
      <Output class='OutStreams' type='Plot'>Emergency-Cooling-System</Output>
    </IOStep>
    <IOStep name="load">
       <Input class='Files' type=''>saphireCSV</Input>
       <Output class='DataObjects' type='PointSet'>saphireDump</Output>
    </IOStep>
  </Steps>

  <DataObjects>
    <PointSet name="saphireDump">
      <Input>
	      time,DGN-FR-lambda,PMP-FR-lambda,
	      DGN-FS,PMP-FS,MOV-CC,MOV-CC-1,CKV-CC,CKV-1,CKV-2
      </Input>
      <Output>
	      LOSP:3_Mean,
	      LOSP:3_5th,
	      LOSP:3_Median,
	      LOSP:3_95th,
	      LOSP:3_Standard~Dev.,
	      LOSP:3_Skewness,
	      LOSP:3_Kurtosis,
	      LOSP:2_Mean,
	      LOSP:2_5th,
	      LOSP:2_Median,
	      LOSP:2_95th,
	      LOSP:2_Standard~Dev.,
	      LOSP:2_Skewness,
	      LOSP:2_Kurtosis,
	      CCS_Mean,
	      CCS_Standard~Dev.,
	      CCS_Skewness,
	      CCS_Kurtosis, 
	      CCS_5th, 
	      CCS_95th,
	      CCS_Median, 
	      ECS_Mean, 
	      ECS_Standard~Dev.,
	      ECS_Skewness,
	      ECS_Kurtosis, 
	      ECS_5th, 
	      ECS_95th,
	      ECS_Median
      </Output>
    </PointSet>
  </DataObjects>

  <OutStreams>
    <Print name="saphirePrint">
      <type>csv</type>
      <source>saphireDump</source>
      <what>input,output</what>
    </Print>
    <Plot name='Large-Release'>
      <plotSettings>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|LOSP:3_5th</y>
	  <marker>^</marker>
	  <c>r</c>
	  <kwargs>
		  <label>5th Percentile</label>
	  </kwargs>
	</plot>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|LOSP:3_95th</y>
	  <marker>v</marker>
	  <c>r</c>
	  <kwargs>
		  <label>95th Percentile</label>
	  </kwargs>
	</plot>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|LOSP:3_Mean</y>
	  <marker>.</marker>
	  <kwargs>
		  <label>Mean</label>
	  </kwargs>
	</plot>
	<xlabel>time</xlabel>
	<ylabel>Large-Release Probability</ylabel>
	<legend>
	  <loc>best</loc>
	</legend>
      </plotSettings>
      <actions>
	      <how>png,screen</how>
	      <scale><yscale>log</yscale></scale>
      </actions>
    </Plot>
    <Plot name='Small-Release'>
      <plotSettings>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|LOSP:2_5th</y>
	  <marker>^</marker>
	  <c>r</c>
	  <kwargs>
		  <label>5th Percentile</label>
	  </kwargs>
	</plot>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|LOSP:2_95th</y>
	  <marker>v</marker>
	  <c>r</c>
	  <kwargs>
		  <label>95th Percentile</label>
	  </kwargs>
	</plot>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|LOSP:2_Mean</y>
	  <marker>.</marker>
	  <kwargs>
		  <label>Mean</label>
	  </kwargs>
	</plot>
	<xlabel>time</xlabel>
	<ylabel>Small-Release Probability</ylabel>
	<legend>
	  <loc>best</loc>
	</legend>
      </plotSettings>
      <actions>
	      <how>png,screen</how>
	      <scale><yscale>log</yscale></scale>
      </actions>
    </Plot>
    <Plot name='Containment-Cooling-System'>
      <plotSettings>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|CCS_5th</y>
	  <marker>^</marker>
	  <c>r</c>
	  <kwargs>
		  <label>5th Percentile</label>
	  </kwargs>
	</plot>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|CCS_95th</y>
	  <marker>v</marker>
	  <c>r</c>
	  <kwargs>
		  <label>95th Percentile</label>
	  </kwargs>
	</plot>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|CCS_Mean</y>
	  <marker>.</marker>
	  <kwargs>
		  <label>Mean</label>
	  </kwargs>
	</plot>
	<xlabel>time</xlabel>
	<ylabel>Containment Cooling System Failed Probability</ylabel>
	<legend>
	  <loc>best</loc>
	</legend>
      </plotSettings>
      <actions>
	      <how>png,screen</how>
	      <scale><yscale>log</yscale></scale>
      </actions>
    </Plot>
    <Plot name='Emergency-Cooling-System'>
      <plotSettings>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|ECS_5th</y>
	  <marker>^</marker>
	  <c>r</c>
	  <kwargs>
		  <label>5th Percentile</label>
	  </kwargs>
	</plot>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|ECS_95th</y>
	  <marker>v</marker>
	  <c>r</c>
	  <kwargs>
		  <label>95th Percentile</label>
	  </kwargs>
	</plot>
	<plot>
	  <type>scatter</type>
	  <x>saphireDump|Input|time</x>
	  <y>saphireDump|Output|ECS_Mean</y>
	  <marker>.</marker>
	  <kwargs>
		  <label>Mean</label>
	  </kwargs>
	</plot>
	<xlabel>time</xlabel>
	<ylabel>Emergency Cooling System Failed Probability</ylabel>
	<legend>
	  <loc>best</loc>
	</legend>
      </plotSettings>
      <actions>
	      <how>png,screen</how>
	      <scale><yscale>log</yscale></scale>
      </actions>
    </Plot>
  </OutStreams>

</Simulation>
