<?xml version="1.0" ?>
<Simulation verbosity='debug'>
  <RunInfo>
    <WorkingDir>data</WorkingDir>
    <Sequence>
      readIn,
      train
    </Sequence>
  </RunInfo>

  <Files>
      <Input name="rawData">../rawData/dummy.csv</Input>
  </Files>

  <Models>
    <ROM name="modelUnderTest" subType="KerasConvNetClassifier">
      <!-- Common setups
           -->
      <pivotParameter>Time</pivotParameter>
      <Features>x1,x2</Features>
      <Target>labels</Target>
      <loss>mean_squared_error</loss>
      <metrics>accuracy</metrics>
      <batch_size>1</batch_size>
      <epochs>40</epochs>
      <plot_model>True</plot_model>
      <validation_split>0.25</validation_split>
      <num_classes>1</num_classes>
      <optimizerSetting>
        <beta_1>0.9</beta_1>
        <optimizer>Adam</optimizer>
        <beta_2>0.999</beta_2>
        <epsilon>1e-8</epsilon>
        <decay>0.0</decay>
        <lr>0.001</lr>
      </optimizerSetting>
      <!-- Setups for CNN
           -->
      <layer name="firstConv1D">
          <type>conv1d</type>
          <activation>relu</activation>
          <strides>1</strides>
          <kernel_size>2</kernel_size>
          <padding>valid</padding>
          <dim_out>32</dim_out>
      </layer>
      <layer name="pooling1">
          <type>MaxPooling1D</type>
          <strides>2</strides>
          <pool_size>2</pool_size>
      </layer>
      <layer name="SecondConv1D">
          <type>conv1d</type>
          <activation>relu</activation>
          <strides>1</strides>
          <kernel_size>2</kernel_size>
          <padding>valid</padding>
          <dim_out>32</dim_out>
      </layer>
      <layer name="pooling2">
          <type>MaxPooling1D</type>
          <strides>2</strides>
          <pool_size>2</pool_size>
      </layer>
      <layer name="flatten">
          <type>Flatten</type>
      </layer>
      <layer name="dense1">
          <type>dense</type>
          <activation>relu</activation>
          <dim_out>10</dim_out>
      </layer>
      <layer name="dropout1">
          <type>dropout</type>
          <rate>0.25</rate>
      </layer>
      <layer name="dropout2">
          <type>dropout</type>
          <rate>0.25</rate>
      </layer>
      <layer name="dense2">
          <type>dense</type>
          <activation>softmax</activation>
      </layer>
      <layer_layout>firstConv1D, pooling1, dropout1, SecondConv1D, pooling2, dropout2,  flatten,dense1,dense2</layer_layout>
    </ROM>
  </Models>
  
  <Steps>
    <IOStep name="readIn">
        <Input class="Files" type="">rawData</Input>  
        <Output class='DataObjects' type='HistorySet'>trainingData</Output>
    </IOStep>
    <RomTrainer name="train">
        <Input class="DataObjects" type="PointSet">trainingData</Input>
        <Output class="Models" type="ROM">modelUnderTest</Output>
    </RomTrainer>
  </Steps>

  <DataObjects>
    <HistorySet name="trainingData">
      <Input>n</Input>
      <Output>x1,x2,labels</Output>
      <options>
          <pivotParameter>Time</pivotParameter>
      </options>
    </HistorySet>
  </DataObjects>

</Simulation>
